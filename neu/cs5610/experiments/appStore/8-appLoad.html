<!DOCTYPE html>
<html>
<head>
<title>App Load</title>
</head>

<link href="css/style.css" type="text/css" rel="stylesheet"/>
<script src="../js/jquery-1.10.2.min.js"></script>

<body>

<header>
	<h1>App Load</h1>
	<time pubdate datetime="2013-09-07"/>
</header>

    <nav>
        <a href="0-store.html">Store</a> |
        <a href="1-summary.0.html">Summary</a> |
        <a href="2-summary.html">Application Rows</a> |
        <a href="3-section.html">Section</a> |
        <a href="4-sectionTable.html">Section Table</a> |
        <a href="5-sectionDynamic.html">Section Dynamic</a> |
        <a href="6-appEditor.html">App Editor</a> |
        <a href="7-appStorage.html">App Save</a> |
        <a href="8-appLoad.html">App Load</a> |
    </nav>

<section class="main-container">
	<article>
		<section class="container radius10 borderGray borderSolid border1px arial">
			<header class="radiusTop10 lightgrayBg padding10 borderBottom1px borderGray borderSolid">
				<h1 class="title noMargin floatLeft">New and Worthy</h1>
				<a href="#" class="marginLeft10">See All &gt;</a>
			</header>

			<div>
				<table class="table" border=1 width="100%" style="margin-bottom:10px">
					<tr class="row">
						<td class="col">
							<div class="app summary arial padding10 width260">
								<img src="images/app1Small.png" class="icon"/>
								<header>	<h1 class="name header noMargin">Contact List</h1></header>
								<span class="category">Utilities</span>
								<div>
									<span class="stars good orange">&#10029; &#10029; &#10029;</span>
									<span class="stars bad  lightgray">&#10029; &#10029;</span>
									<span class="rating">957</span> Ratings<br/>
									<a class="grayBg radius10 noTextDecoration white priceLink" href="#">$9.99</a>
									<select class="relativePosition share">
										<option>Copy Link</option>
										<option>Tell a Friend</option>
										<option>Share on Twitter</option>
										<option>Share to Facebook</option>
										<option>Share in Messages</option>
									</select>
								</div>
							</div>
						</td>
						<td>
							<div class="app summary arial padding10 width260">
								<img src="images/app2Small.png" class="icon"/>
								<header>	<h1 class="header noMargin">Contact List</h1></header>
								<span>Utilities</span>
								<div>
									<span class="orange">&#10029; &#10029; &#10029;</span>
									<span class="lightgray">&#10029; &#10029;</span>
									<span>957</span> Ratings<br/>
									<a class="grayBg radius10 noTextDecoration white priceLink" href="#">$9.99</a>
									<select class="relativePosition share">
										<option>Copy Link</option>
										<option>Tell a Friend</option>
										<option>Share on Twitter</option>
										<option>Share to Facebook</option>
										<option>Share in Messages</option>
									</select>
								</div>
							</div>
						</td>
						<td>
							<div class="app summary arial padding10 width260">
								<img src="images/app3Small.png" class="icon"/>
								<header>	<h1 class="header noMargin">Contact List</h1></header>
								<span>Utilities</span>
								<div>
									<span class="orange">&#10029; &#10029; &#10029;</span>
									<span class="lightgray">&#10029; &#10029;</span>
									<span>957</span> Ratings<br/>
									<a class="grayBg radius10 noTextDecoration white priceLink" href="#">$9.99</a>
									<select class="relativePosition share">
										<option>Copy Link</option>
										<option>Tell a Friend</option>
										<option>Share on Twitter</option>
										<option>Share to Facebook</option>
										<option>Share in Messages</option>
									</select>
								</div>
							</div>
						</td>
					</tr>
					<tr class="lightgrayBg">
						<td>
							<div class="app summary arial padding10 width260">
								<img src="images/app2Small.png" class="icon"/>
								<header>	<h1 class="header noMargin">Contact List</h1></header>
								<span>Utilities</span>
								<div>
									<span class="orange">&#10029; &#10029; &#10029;</span>
									<span class="lightgray">&#10029; &#10029;</span>
									<span>957</span> Ratings<br/>
									<a class="grayBg radius10 noTextDecoration white priceLink" href="#">$9.99</a>
									<select class="relativePosition share">
										<option>Copy Link</option>
										<option>Tell a Friend</option>
										<option>Share on Twitter</option>
										<option>Share to Facebook</option>
										<option>Share in Messages</option>
									</select>
								</div>
							</div>		
						</td>
						<td>
							<div class="app summary arial padding10 width260">
								<img src="images/app3Small.png" class="icon"/>
								<header>	<h1 class="header noMargin">Contact List</h1></header>
								<span>Utilities</span>
								<div>
									<span class="orange">&#10029; &#10029; &#10029;</span>
									<span class="lightgray">&#10029; &#10029;</span>
									<span>957</span> Ratings<br/>
									<a class="grayBg radius10 noTextDecoration white priceLink" href="#">$9.99</a>
									<select class="relativePosition share">
										<option>Copy Link</option>
										<option>Tell a Friend</option>
										<option>Share on Twitter</option>
										<option>Share to Facebook</option>
										<option>Share in Messages</option>
									</select>
								</div>
							</div>
						</td>
						<td>					
							<div class="app summary arial padding10 width260">
								<img src="images/app1Small.png" class="icon"/>
								<header>	<h1 class="header noMargin">Contact List</h1></header>
								<span>Utilities</span>
								<div>
									<span class="orange">&#10029; &#10029; &#10029;</span>
									<span class="lightgray">&#10029; &#10029;</span>
									<span>957</span> Ratings<br/>
									<a class="grayBg radius10 noTextDecoration white priceLink" href="#">$9.99</a>
									<select class="relativePosition share">
										<option>Copy Link</option>
										<option>Tell a Friend</option>
										<option>Share on Twitter</option>
										<option>Share to Facebook</option>
										<option>Share in Messages</option>
									</select>
								</div>
							</div>
						</td>
					</tr>
				</table>
			</div>
		</section>
	</article>
</section>

<footer>
    <a target="_blank" href="../../../fileview/Default.aspx?~/experiments/appStore/8-appLoad.html">View Source</a>
</footer>

<script>

	/*
	 * Grab static template DOM
	 */
	var mainContainer = $(".main-container");
	var appContainerTemplate = $(".container").clone();
	var tableTemplate = $(".container .table").clone();
	var rowTemplate = $(".container .table .row").clone();
	var colTemplate = $(".container .table .row .col").clone();

	$(".container").remove();
	
	/*
	 * Data Driven
	 */

	var appSummaries = localStorage.getItem("appSummaries");
	appSummaries = JSON.parse(appSummaries);
	
	console.log(appSummaries);
	
	sectionData = [];
	appRow = [];
	var row = col = 0;
	for(var a in appSummaries) {
		var appSummary = appSummaries[a];
		appRow.push(appSummary);
		col++;
		if(col>=3) {
			row++;
			col = 0;
			sectionData.push(appRow);
			appRow = [];
		}
	}
	sectionData.push(appRow);

	// Iterate over the data and print it
	for(var row=0; row<sectionData.length; row++) {
		var appSummaries = sectionData[row];
		for(var col=0; col<appSummaries.length; col++) {
			var appData = appSummaries[col];
			console.log(appData)
		}
	}

	var STARS = [
		"",
		"&#10029;",
		"&#10029; &#10029;",
		"&#10029; &#10029; &#10029;",
		"&#10029; &#10029; &#10029; &#10029;",
		"&#10029; &#10029; &#10029; &#10029; &#10029;",
	];

	// Table clone
	var tableCopy3 = tableTemplate.clone();
	tableCopy3.find("tbody").empty();

	// Dynamically Create a Section
	for(var row=0; row<sectionData.length; row++) {
		// create a row copy for every data row
		var rowCopy = rowTemplate.clone();
		rowCopy.empty();
		var appSummaries = sectionData[row];
		for(var col=0; col<appSummaries.length; col++) {
			var colCopy = colTemplate.clone();
			var appData = appSummaries[col];
			colCopy.find(".name").html(appData.name);
			colCopy.find(".category").html(appData.category);
			colCopy.find(".priceLink").html(appData.price);
			colCopy.find(".rating").html(appData.rating);
			colCopy.find(".stars.good").html(STARS[appData.stars]);
			colCopy.find(".stars.bad").html(STARS[5-appData.stars]);
			var image = appData.image;
			image = image.substring(image.lastIndexOf("\\"));
			image = "images/"+image;
			colCopy.find(".icon").attr("src", image);
			rowCopy.append(colCopy)
			console.log(appData);
		}
		tableCopy3.find("tbody").append(rowCopy)
	}

	var appContainerCopy3 = appContainerTemplate.clone();
	appContainerCopy3.find(".table").remove();	
	appContainerCopy3.append(tableCopy3)	
	
	// change the container's title
	appContainerCopy3
		.find(".title")
		.html("Dynamic");

	mainContainer.append(appContainerCopy3);


</script>

</body>
</html>